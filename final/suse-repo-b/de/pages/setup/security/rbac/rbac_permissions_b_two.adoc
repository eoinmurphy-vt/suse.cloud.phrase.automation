= Berechtigungen
:revdate: 2025-07-10
:page-revdate: {revdate}
:description: SUSE Observability Selbstgehostet

== Übersicht

Mithilfe von Berechtigungen in SUSE Observability können Administratoren die Aktionen verwalten, die jeder Benutzer oder jede Benutzergruppe in SUSE Observability durchführen kann, sowie die Informationen, die in der SUSE Observability-Benutzeroberfläche angezeigt werden. Es werden nur die Funktionen angezeigt, die für die aktive Rolle des jeweiligen Nutzers relevant sind. Die Aktionen, Informationen und Seiten, auf die ein Benutzer keinen Zugriff hat, werden in der SUSE Observability-Benutzeroberfläche einfach nicht angezeigt.

[NOTE]
====
Berechtigungen werden in StackGraph gespeichert. Dies bedeutet, dass:

* Wenn Sie ein Upgrade mit "Alle Daten löschen" durchführen, wird auch die Berechtigungseinrichtung entfernt.
* Um einen Benutzer vollständig zu entfernen, muss er auch manuell aus StackGraph entfernt werden.
====


== SUSE Observability-Berechtigungen

In SUSE Observability gibt es zwei Arten von Berechtigungen. Die *Systemberechtigungen* umfassen die Fähigkeiten der Benutzer, z. B. den Zugriff auf Einstellungen, die Ausführung von Abfragen und Skripten. *Zugriffsberechtigungen* bestimmen den Zugriff auf Observability-Daten und einige Ressourcentypen wie SUSE Observability Views.  Bei CRUD-Vorgängen auf SUSE Observability Views können diese für eine bestimmte Ansicht oder für alle Ansichten gewährt werden. Einzelheiten zu den Berechtigungen, die jeder vordefinierten Rolle in SUSE Observability zugeordnet sind, finden Sie unter xref:/setup/security/rbac/rbac_roles.adoc#_predefined_roles[Vordefinierte Rollen]

Die folgenden Berechtigungen sind in SUSE Observability verfügbar:

.Berechtigungen
[cols="2,2,5"]
|===
|Ressourcen |Verbs |Beschreibung

|Agenten
|bekommen.
|Verbundene Agenten

|api-tokens
|bekommen.
|Der API-Schlüssel, der für die Authentifizierung mit der SUSE Observability CLI verwendet wird.  Dies ist einmalig pro Benutzer.

|Komponenten-Aktionen
|ausführen.
|xref:/use/views/k8s-topology-perspective.adoc#_actions[Komponentenaktionen in der Topologieperspektive].

|metrische Bindungen
|abrufen, erstellen, aktualisieren, löschen
ifdef::ss-ff-stackpacks2_enabled[]
|xref:/setup/custom-integrations/metric-bindings/index.adoc[Bindungen zur Visualisierung von Daten in der Metrik-Perspektive].
endif::[]
ifndef::ss-ff-stackpacks2_enabled[]
|xref:/use/metrics/k8s-add-charts.adoc[Bindungen zur Visualisierung von Daten in der Metrik-Perspektive].
endif::[]

|Metriken
|get\^[1]^, update
|Einlesen und Abfragen metrischer Daten mit PromQL

|überwacht
|abrufen, erstellen, aktualisieren, löschen, ausführen
|xref:/use/alerting/k8s-monitors.adoc[Bestimmen Sie den Zustand der Komponenten mit Monitoren].

|Benachrichtigungen
|abrufen, erstellen, aktualisieren, löschen
|xref:/use/alerting/notifications/configure.adoc[Lassen Sie sich mit Benachrichtigungen alarmieren].

|Berechtigungen
|holen, aktualisieren
|Verwalten Sie Berechtigungen für Themen.

|scoped-permissions
|Update\^[1]^
|Verwalten Sie Zugriffsrechte, indem Sie den Zugriff auf Topologie, Metriken und Traces eines einzelnen Clusters gewähren (oder entziehen).

|Skripte
|ausführen.
|Führen Sie ein Skript in der SUSE Observability UI Analytics-Umgebung aus.

|Skripte mit eingeschränktem Zugriff
|ausführen.
|Verwenden Sie das HTTP-Skript und die Gremlin-Graph-API in der Analytics-Umgebung.

|Service-Token
|holen, erstellen, löschen
|xref:/use/security/k8s-service-tokens.adoc[Service-Tokens] authentifizieren einen externen Dienst und können für die Dateneingabe verwendet werden.

|Einstellungen
|holen, aktualisieren, entsperren
|Exportieren oder importieren Sie Einstellungen oder entsperren Sie xref:/stackpacks/about-stackpacks.adoc#_locked_configuration_items[gesperrte Konfigurationselemente].

|Rucksäcke
|holen, aktualisieren
|xref:/stackpacks/about-stackpacks.adoc[Stackpacks] auflisten oder hochladen.

|Stackpack-Konfigurationen
|erstellen, aktualisieren, löschen
|Verwalten Sie Integrationen mit xref:/stackpacks/about-stackpacks.adoc[Stackpacks].

|sync-data
|holen, löschen
|Überprüfen oder Zurücksetzen der Topologie- und Zustands-Synchronisations-Pipelines.

|System-Benachrichtigungen
|bekommen.
|Zugriff auf die Systembenachrichtigungen in der Benutzeroberfläche

|Themen-Meldungen
|bekommen.
|Zugriff auf SUSE Observability Receiver-Daten.

|Topologie
|get\^[1]^
|xref:/use/views/k8s-views.adoc[Untersuchen Sie topologiebezogene Ansichten].

|Spuren
|get\^[1]^
|xref:/use/traces/k8sTs-explore-traces.adoc[Spuren erforschen].

|Ansichten
|get^[1]^, create, update^[1]^, delete^[1]^
|xref:/use/views/k8s-custom-views.adoc[Benutzerdefinierte Ansichten] verwenden oder verwalten.

|Favoriten-Ansichten
|erstellen, löschen
|Hinzufügen und Entfernen von Sternen aus Ansichten.

|Visualisierung
|Update
|Ändern Sie die xref:/use/views/k8s-topology-perspective.adoc#_visualization_settings[Visualisierungseinstellungen].

|===
\^[1]^ Es handelt sich um eine *beschränkte Erlaubnis*; die Interpretation des Ressourcennamens hängt vom Kontext ab.

=== Eingeschränkte Berechtigungen

Sie können bestimmte Berechtigungen systemweit erteilen oder sie auf eine Teilmenge der Ressourcen beschränken.  Sie können ihnen einen *Ressourcennamen* geben, der den Umfang angibt.  Die Interpretation dieses Namens hängt von der Art der Ressource ab.  Beachten Sie, dass der Geltungsbereich möglicherweise nur für einige der Verben gilt.

* `views` - Der Name der Ansicht
* `topology` - Jedes Komponentenetikett. In einer Kubernetes-Umgebung kann dies z. B. `cluster-name:<cluster-name>` oder `k8s-scope:<cluster-name>/<namespace>`
* `metrics` - In einer Kubernetes-Umgebung können entweder `k8s:<cluster-name>:\\__any__` oder `k8s:<cluster-name>:<namespace>`
* `traces` - In einer Kubernetes-Umgebung können entweder `k8s.cluster.name:<cluster-name>` oder `k8s.scope:<cluster-name>/<namespace>`
* `scoped-permissions` - Der Name des Clusters, für den die Berechtigungen verwaltet werden

== Berechtigungen verwalten

Sie können die SUSE Observability-Berechtigungen über die `sts` CLI verwalten.
Für "scoped permissions" kann ein Ressourcenname angegeben werden.  Wird keine angegeben, wird die Erlaubnis systemweit erteilt (oder entzogen).

[NOTE]
====
*Wichtiger Hinweis:* Bei allen Berechtigungen in SUSE Observability wird zwischen Groß- und Kleinschreibung unterschieden.
====


=== Alle verfügbaren Berechtigungen auflisten

Alle verfügbaren Berechtigungen auflisten:

[,text]
----
sts rbac list-permissions
----

=== Alle Themen auflisten

Alle Themen auflisten:

[,text]
----
sts rbac describe-subjects

SUBJECT                                    | SOURCE
stackstate-admin                           | Static
suse-observability-instance-admin          | Kubernetes
suse-observability-agent-clusterA          | Observability
----
[NOTE]
====
Das Thema `+SOURCE` zeigt an, wer das Thema besitzt und verwaltet. Es kann eine unserer RBAC-Quellen sein (Configuration|Static, Observability, Kubernetes)

* Konfiguration|Statisch: Subjekte, die über die Suse Observability-Konfiguration durch helm
* Observierbarkeit: Über die sts cli verwaltete Fächer
* Kubernetes: Subjekte, die über den RBAC-Agenten aus Kubernetes RoleBindings und ClusterRoleBindings bezogen werden
====

=== Themen für einen Benutzer auflisten

Auflistung aller Subjekte, die dem Kontext zugewiesen sind; der erste angezeigte Eintrag ist der Benutzername und die möglichen Rollen, die der Benutzer hat:

[,text]
----
sts user-session roles

user-dkzwh
keycloakoidc_group://suse-observability-instance-troubleshooter
keycloakoidc_group://suse-observability-instance-observer
keycloakoidc_group://suse-observability-cluster-observer
keycloakoidc_group://suse-observability-instance-admin
keycloakoidc_group://suse-observability-observer
----

Auflistung aller Themen, die einem Benutzer zugewiesen sind, unter Angabe ihrer `api-token`(nützlich, da der Administrator bei der Fehlersuche bei Benutzern mit weniger Berechtigungen helfen kann):

[,text]
----
sts user-session roles --api-token [api-token]

u-3p775e7w7l
keycloakoidc_group://suse-observability-cluster-observer
----

=== Erteilte Berechtigungen anzeigen

Zeigt die einem bestimmten Benutzer oder einer bestimmten Rolle gewährten Berechtigungen an.

[,text]
----
sts rbac describe-permissions --subject [role-name]

PERMISSION   | RESOURCE
get-topology | cluster-name:rbac-t2
get-traces   | k8s.cluster.name:rbac-t2
get-metrics  | k8s:rbac-t2:__any__
----

[NOTE]
====
`--subject` kann jedes der in den verschiedenen RBAC-Quellen verfügbaren Themen sein (Konfiguration, Beobachtbarkeit, Kubernetes)
====

=== Erteilung von Genehmigungen
[NOTE]
====
`--subject` kann ein Observability-Thema sein, Konfigurations- und Kubernetes-Themen sind schreibgeschützt
====

==== Einem Benutzer erlauben, eine Ansicht zu öffnen

Geben Sie einem Subjekt die Erlaubnis, eine Ansicht zu öffnen:

[,text]
----
sts rbac grant --subject [role-name] --permission get-views --resource [view-name]
----

==== Einem Benutzer erlauben, Ansichten zu erstellen

Geben Sie einem Subjekt mit dem System die Berechtigung, Ansichten zu erstellen:

[,text]
----
sts rbac grant --subject [role-name] --permission create-views
----

==== Erlauben Sie einem Benutzer, die Einstellungen von SUSE Observability zu überprüfen

Geben Sie einer Person mit dem System die Berechtigung, die Einstellungen von SUSE Observability zu überprüfen:

[,text]
----
sts rbac grant --subject [role-name] --permission get-settings
----

=== Berechtigungen entziehen
[NOTE]
====
`--subject` kann ein Observability-Thema sein, Konfigurations- und Kubernetes-Themen sind schreibgeschützt
====

Entziehen Sie einem Subjekt die Berechtigung, eine Ansicht zu öffnen:

[,text]
----
sts rbac revoke --subject [role-name] --permission get-views --resource [view-name]
----

== SUSE Observability UI ohne Berechtigungen

Nachfolgend sehen Sie ein Beispiel dafür, wie die SUSE Observability-Benutzeroberfläche für einen Benutzer ohne jegliche Berechtigungen aussehen würde:

image::noperm.png[Keine Genehmigungen]
