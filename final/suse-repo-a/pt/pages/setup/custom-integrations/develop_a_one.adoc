ifdef::ss-ff-stackpacks2_enabled[]
= Tutorial: Desenvolva uma Integra√ß√£o Personalizada (StackPack)
:revdate: 2026-01-08
:page-revdate: {revdate}
:description:  Desenvolva uma Integra√ß√£o Personalizada (StackPack)

[IMPORTANT]
====
Este recurso est√° em pr√©-produ√ß√£o e n√£o foi lan√ßado. Est√° dispon√≠vel apenas se a vari√°vel de ambiente `STS_EXPERIMENTAL_STACKPACK` estiver definida. Altera√ß√µes incompat√≠veis podem ocorrer.
====

== Meta

Como desenvolvedor, voc√™ deseja integrar sua tecnologia com {stackstate-product-name} ao construir um StackPack personalizado. Este tutorial o guia pelo processo usando o StackPack CLI.

== Pr√©-requisitos

- Acesso ao xref:/setup/cli/cli-sts.adoc[StackPack CLI]
- Flag de funcionalidade habilitada:
+
[source,bash]
----
export STS_EXPERIMENTAL_STACKPACK=true
----


== Como Desenvolver uma Integra√ß√£o Personalizada (StackPack)

=== Crie um novo StackPack

O subcomando `scaffold` cria uma nova estrutura de projeto StackPack a partir de modelos configur√°veis, agilizando o processo de configura√ß√£o inicial para o desenvolvimento do StackPack. O comando suporta tanto modelos de diret√≥rio local quanto modelos hospedados no GitHub.

- Crie um novo projeto StackPack usando a CLI:
+
[source,bash]
----
sts stackpack scaffold --name my-stackpack
----

- Para usar um modelo espec√≠fico do GitHub (padr√£o: https://github.com/StackVista/stackpack-templates[stackvista/stackpack-templates]):
+
[source,bash]
----
sts stackpack scaffold --name my-stackpack --template-github-repo stackvista/stackpack-templates --template-name microservice --destination-dir stackpack
‚úì Validating arguments...
‚úì Checking destination directory...
‚úì Fetching template from github:stackvista/stackpack-templates@main:templates
‚úì Rendering templates...
‚úì Validating rendered templates...
‚úì Copying files to destination...
Files copied:
  README.md
  provisioning/dashboard.sty
  provisioning/metricbindings.sty
  provisioning/monitors.sty
  provisioning/remediation-hints/node-memory-pressure.md.hbs
  provisioning/stackpack.sty
  resources/deprovisioning.md
  resources/error.md
  resources/installed.md
  resources/logo.png
  resources/notinstalled.md
  resources/overview.md
  resources/provisioning.md
  resources/waitingfordata.md
  stackpack.yaml

‚úÖ ‚úì Scaffold complete!

Next steps:
1. Review the generated files in: ./my-stackpack
2. Check the ./my-stackpack/README.md for instructions on what to do next.
...
----

+
- Para usar um modelo local:
+
[source,bash]
----
sts stackpack scaffold --name my-stackpack --template-local-dir ./templates --template-name webapp
----


=== Revise e personalize

- Revise os arquivos gerados no diret√≥rio de destino.
- Edite `stackpack.yaml` e outros arquivos para definir sua l√≥gica de integra√ß√£o.
  * Integrando dados. Para mapear componentes e ingerir m√©tricas, veja xref:setup/custom-integrations/otelmappings/README.adoc[Adicionando Mapeamentos de Telemetria Otel]
  * xref:setup/custom-integrations/monitors/index.adoc[Adicionando Monitores]
  * xref:setup/custom-integrations/metric-bindings/index.adoc[Adicionando V√≠nculos de M√©trica]

[NOTE]
====
O modelo padr√£o: https://github.com/StackVista/stackpack-templates[stackvista/stackpack-templates] √© um √≥timo ponto de partida, pois cont√©m exemplos para a maioria dos pontos de extens√£o, como Monitores e V√≠nculos de M√©tricas.
====

=== Teste seu StackPack

O subcomando `test` que simplifica o fluxo de trabalho de desenvolvimento do StackPack, automatizando a sequ√™ncia pacote ‚Üí upload ‚Üí instala√ß√£o/atualiza√ß√£o, com gerenciamento autom√°tico de vers√µes para itera√ß√µes de teste.

- Teste rapidamente seu StackPack em um ambiente de pr√©-produ√ß√£o (requer uma inst√¢ncia SUSE Observability em execu√ß√£o):
+
[source,bash]
----
sts stackpack test -d ./my-stackpack --yes
‚úÖ Starting stackpack test sequence...
  Stackpack: my-stackpack (current version: 0.0.1)

Step 1/5: Checking installed version...

Step 2/5: Creating temporary copy for testing...
‚úÖ ‚úì Temporary copy created

Step 3/5: Bumping version for testing...
‚úÖ ‚úì Version bumped to: 0.0.1-cli-test.10000

Step 4/5: Packaging stackpack...
‚úÖ ‚úì Stackpack packaged successfully!

Stackpack: my-stackpack (v0.0.1-cli-test.10000)
Zip file: /Users/viliakov/Workspace/src/github/stackstate-cli/my-stackpack/my-stackpack-0.0.1-cli-test.10000.zip
‚úÖ ‚úì Stackpack packaged successfully

Step 5/5: Uploading and installing/upgrading stackpack...
‚úÖ Uploaded StackPack: /Users/viliakov/Workspace/src/github/stackstate-cli/my-stackpack/my-stackpack-0.0.1-cli-test.10000.zip
NAME              | DISPLAY NAME      | VERSION
my-stackpack | my-stackpack | 0.0.1-cli-test.10000
‚úÖ ‚úì Stackpack uploaded successfully
‚úÖ StackPack instance installed
ID             | NAME | STATUS      | VERSION         | LAST UPDATED
274027256960772 | -    | PROVISIONING | 0.0.1-cli-test.1 | Fri Aug 29 09:10
                |      |              | 0000             | :26 2025 CEST
‚úÖ ‚úì Stackpack installed successfully

‚úÖ üéâ Test sequence completed successfully!
----

- O subcomando `test` empacota, faz upload e instala seu StackPack com um sufixo de vers√£o¬†de teste.
- Itere sobre seu StackPack, usando o comando `test` para feedback r√°pido, fa√ßa altera√ß√µes e observe que o processo de instala√ß√£o/atualiza√ß√£o foi executado com sucesso. Revise a topologia e a telemetria ingeridas na interface do usu√°rio do SUSE Observability UI.

=== Empacote sua vers√£o final do StackPack

O subcomando `package` cria um arquivo zip a partir dos diret√≥rios do StackPack. Este comando empacota todos os arquivos e diret√≥rios necess√°rios do StackPack em um arquivo zip nomeado corretamente para distribui√ß√£o e implanta√ß√£o.

- Empacote seu StackPack em um zip distribu√≠vel:
+
[source,bash]
----
sts stackpack package -d ./my-stackpack
‚úÖ ‚úì Stackpack packaged successfully!

Stackpack: stackpack (v0.0.1)
Zip file: /Users/viliakov/Workspace/src/github/stackstate-cli/my-stackpack/my-stackpack-0.0.1-cli-test.zip
----

- Para especificar o arquivo de sa√≠da:
+
[source,bash]
----
sts stackpack package -d ./my-stackpack -f my-custom-archive.zip
----

=== Fa√ßa upload do seu StackPack

O subcomando `upload` envia o arquivo zip para uma inst√¢ncia {stackstate-product-name} em execu√ß√£o.

- Fa√ßa upload do arquivo compactado para {stackstate-product-name}:
+
[source,bash]
----
sts stackpack upload -f ./my-stackpack-0.0.1.zip
‚úÖ ‚úì Stackpack uploaded successfully!
----

=== Instale o StackPack

xref:/stackpacks/about-stackpacks.adoc#_install_or_uninstall_a_stackpack[Instale ou atualize seu StackPack] via a {stackstate-product-name} Stackpacks UI.

endif::ss-ff-stackpacks2_enabled[]
