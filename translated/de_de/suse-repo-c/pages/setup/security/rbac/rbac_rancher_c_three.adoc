= Rancher RBAC
:revdate: 2025-07-10
:page-revdate: {revdate}
:description: SUSE Observability Self-hosted

== Übersicht

Die SUSE Rancher Prime Observability Erweiterung verwendet Kubernetes RBAC, um Rancher-Benutzern in SUSE Observability Zugriff zu gewähren.
Wenn Sie Rancher nicht verwenden, sehen Sie sich xref:/setup/security/rbac/rbac_roles.adoc[Einrichten von Rollen] in einer eigenständigen Installation an.

[NOTE]
====
Damit Rancher RBAC funktioniert, 

* Die Authentifizierung für {stackstate-product-name} muss mit dem xref:setup/security/authentication/oidc.adoc#_rancher[Rancher OIDC Provider] konfiguriert werden.
* Der {stackstate-product-name} Agent muss den RBAC Agent aktiviert haben und sich mit einem Diensttoken authentifizieren.
====

Jeder authentifizierte Benutzer hat die Rolle *Instanz-Basiszugriff*, die es ihm ermöglicht, das System zu nutzen.  Diese Berechtigungen gewähren Zugriff auf die Ansichten, Einstellungen, Metrikbindungen und ermöglichen es einem Benutzer, Systembenachrichtigungen anzuzeigen.  Sie gewähren KEINEN Zugriff auf {stackstate-product-name} Daten.  Um Daten zu sehen, muss einem Benutzer eine zusätzliche Rolle zugewiesen werden. Zwei Möglichkeiten zur Erweiterung der Rolle *Instanz-Basiszugriff* werden mit Rancher *Rollenvorlagen* bereitgestellt:

Instanzrollen:: Ermöglicht Ihnen, {stackstate-product-name} zu konfigurieren oder zu personalisieren.
Bereichsbezogene Rollen:: Gewährt Zugriff auf die {stackstate-product-name} Daten aus beobachteten Clustern.

== Instanzrollen

Sie können die *Rollenvorlagen* für *Instanzrollen* an Benutzern oder Gruppen im *Projekt* zuweisen, das {stackstate-product-name} ausführt. Wenn keine Instanzrollen explizit einem Mitglied eines Projekts zugewiesen sind, haben sie die Berechtigungen der Rolle *Instanz-Basiszugriff*.

=== Instanzrollen mit Zugriff auf {stackstate-product-name} Daten

Einige "globale" Rollen erlauben den Zugriff auf alle {stackstate-product-name} Daten – in allen beobachteten Clustern.  Diese Rollen sind dafür gedacht, das System einzurichten und Probleme auf Systemebene zu beheben.  Für Benutzer mit einer dieser Rollen ist es nicht notwendig, xref:scoped[bereichsbezogene Rollen] zu konfigurieren.

Instanzadministrator:: Gewährt vollen Zugriff auf alle Ansichten und alle Berechtigungen.
Instanz-Fehlerbeheber:: Gewährt alle Berechtigungen, die erforderlich sind, um SUSE Observability zur Fehlersuche zu verwenden, einschließlich der Möglichkeit, Monitore zu aktivieren/deaktivieren, benutzerdefinierte Ansichten zu erstellen und die CLI zu verwenden.
Instanzbeobachter:: Gewährt Zugriff auf alle Daten in einer SUSE Observability-Instanz.

=== Instanzrollen ohne Zugriff auf {stackstate-product-name} Daten

Diese Rollen müssen mit der *Instanzbeobachter*-Rolle oder einer der xref:scoped[bereichsbezogene Rollen] (siehe unten) kombiniert werden.  Andernfalls sind keine {stackstate-product-name} Daten zugänglich und die Benutzeroberfläche zeigt die Nachricht "Keine Komponenten gefunden" an.  Dies gilt für alle Rancher-Benutzer, einschließlich Projektleitern.

Empfohlener Instanzzugriff:: Gewährt empfohlene Berechtigungen zur Nutzung von SUSE Observability.  Diese Rolle umfasst Berechtigungen, die nicht unbedingt erforderlich sind, aber (eingeschränkte) Möglichkeiten zur Personalisierung bieten {stackstate-product-name}.
Instanz-Basiszugriff:: Gewährt minimale Berechtigungen zur Nutzung von {stackstate-product-name}. Diese Rolle muss nicht explizit zugewiesen werden und es gibt keine *Rollenvorlage* dafür; jeder angemeldete Benutzer hat sie. 

Unten finden Sie die Berechtigungen, die jeder vordefinierten SUSE Observability-Rolle zugewiesen sind. Für Details zu den verschiedenen Berechtigungen und wie Sie diese mit der `+sts+` CLI verwalten können, siehe xref:/setup/security/rbac/rbac_permissions.adoc[Rollenbasierte Zugriffskontrolle (RBAC)-Berechtigungen]

[tabs]
====
Basiszugang::
+
--
Der Basiszugang gewährt minimale Berechtigungen zur Nutzung von SUSE Observability. Zur Kombination mit einem Beobachter (Instanz, Cluster oder Projekt).
Diese Berechtigungen werden allen Benutzern gewährt.

|===
|Ressource |Verben 

|Metrikbindungen |get
|Einstellungen |get
|Systembenachrichtigungen |get
|Layouts |get
|===

--
Empfohlener Zugriff::
+
--
Der empfohlene Zugriff gewährt Berechtigungen, die nicht unbedingt erforderlich sind, aber SUSE Observability viel nützlicher machen. Er bietet einen begrenzten Grad an Personalisierung.
Zur Kombination mit einem Beobachter (Instanz, Cluster oder Projekt).

|===
|Ressource |Verben 

|API-Tokens |get
|Favoriten-Dashboards |erstellen, löschen
|Favoritenansichten |erstellen, löschen
|stackpacks |get 
|Visualisierungseinstellungen |update
|===

--
Beobachter::
+
--
Der Beobachter gewährt Zugriff auf alle Observability-Daten in einer SUSE Observability-Instanz.  Kombinieren Sie dies mit *Empfohlenem Zugriff* für ein besseres Erlebnis.

|===
|Ressource |Verben 

|Topologie |get
|Metriken |get
|Spuren |get
|===

--
Fehlerbeheber::
+
--
Die Rolle des Fehlerbehebers hat Zugriff auf alle in SUSE Observability verfügbaren Daten und die Möglichkeit, Ansichten zu erstellen und Monitore zu aktivieren/deaktivieren.

|===
|Ressource |Verben 

|Agenten |get 
|API-Tokens |get
|Komponenten-Aktionen |execute
|Dashboards |abrufen, erstellen, aktualisieren, löschen 
|Favoriten-Dashboards |erstellen, löschen
|Favoritenansichten |erstellen, löschen
|Metrikbindungen |get
|Metriken |get 
|Monitore |abrufen, erstellen, aktualisieren, löschen, ausführen 
|Benachrichtigungen |abrufen, erstellen, aktualisieren, löschen 
|Einstellungen |get 
|Stackpack-Konfigurationen |abrufen, erstellen, aktualisieren, löschen
|stackpacks |get 
|Systembenachrichtigungen |get
|Topologie |get 
|Spuren |get 
|Layouts |abrufen, erstellen, aktualisieren, löschen 
|Visualisierungseinstellungen |get
|===

--
Admin.::
+
--
Die Rolle des Administrators hat alle Berechtigungen zugewiesen.

|===
|Ressource |Verben 

|Agenten |get 
|API-Tokens |get
|Komponenten-Aktionen |execute
|Dashboards |abrufen, erstellen, aktualisieren, löschen 
|Favoriten-Dashboards |erstellen, löschen
|Favoritenansichten |erstellen, löschen
|Ingestion-API-Schlüssel |abrufen, erstellen, aktualisieren, löschen
|Metrik-Bindungen |get
|Metriken |get 
|Monitore |abrufen, erstellen, aktualisieren, löschen, ausführen 
|Benachrichtigungen |abrufen, erstellen, aktualisieren, löschen 
|permissions |abrufen, erstellen, aktualisieren, löschen 
|eingeschränkte Skripte |execute
|Dienst-Tokens |abrufen, erstellen, aktualisieren, löschen
|Einstellungen |abrufen, erstellen, aktualisieren, löschen, entsperren 
|Stackpack-Konfigurationen |abrufen, erstellen, aktualisieren, löschen
|stackpacks |abrufen, erstellen 
|sync-data |abrufen, aktualisieren, löschen
|Systembenachrichtigungen |get
|Themen-Nachrichten |get
|Topologie |get 
|Spuren |get 
|Layouts |abrufen, erstellen, aktualisieren, löschen 
|Visualisierungseinstellungen |update
|===

--
====

[#scoped]
== Bereichsbezogene Rollen

Sie können die folgenden *Rollenvorlagen* Benutzern oder Gruppen in einem beobachteten Cluster zuweisen.  Sie gewähren Zugriff auf {stackstate-product-name} Daten, die von (einem *Projekt* in) dem *Cluster* stammen, und geben einem Benutzer die Berechtigung, Topologie, Metriken, Protokolle und Tracedaten zu lesen.

Beobachter:: Gewährt Zugriff auf Daten, die aus Namespaces in einem *Projekt* stammen. Sie können dies im Abschnitt *Projektmitgliedschaft* der Clusterkonfiguration verwenden.
Cluster-Beobachter:: Gewährt Zugriff auf alle Daten, die von einem *Cluster* stammen. Sie können diese Vorlage im Abschnitt *Cluster-Mitgliedschaft* der Clusterkonfiguration verwenden.

Die Ressourcen in diesen Rollen entsprechen xref:/setup/security/rbac/rbac_permissions.adoc#_scoped_permissions[bereichsbezogene Berechtigungen]. Sie sind in der `+scope.observability.cattle.io+` API-Gruppe verfügbar (mit nur Verb `+get+`, da diese Ressourcen nur lesbar sind):

* `+topology+` - Komponenten (Bereitstellungen, Pods usw.) aus dem Cluster oder Namespace
* `+traces+` - Spans aus dem Cluster oder Namespace
* `+metrics+` - Metrikdaten, die aus dem Cluster oder dem Namespace stammen

Beachten Sie, dass der Zugriff auf Protokolle durch die `+topology+` Ressource gesteuert wird.

Aktivieren Sie die Personalisierung für Benutzer mit diesen Beobachterrollen, indem Sie die Rolle *Empfohlener Instanzzugriff* im *Projekt* gewähren, in dem {stackstate-product-name} ausgeführt wird.

== Benutzerdefinierte Rollen

Um zusätzliche Berechtigungen über den empfohlenen Zugriff hinaus zu gewähren, erstellen Sie eine benutzerdefinierte Projekt-*RoleTemplate* in Rancher, die von *SUSE Observability Empfohlenem Instanzzugriff* erbt.  Fügen Sie dann beispielsweise Regeln hinzu, um die Rechte zum Anzeigen von Monitoren und Metrikdiagrammen zu gewähren, mit:

* Verb: `+get+`
* Ressource: `+metricbindings+` und `+monitors+`
* ApiGroup: `+instance.observability.cattle.io+`

image::rancher-custom-role.png[Benutzerdefinierte Rollenvorlage für umfassenderen Zugriff]

Sie können jede Ressourcen- und Verb-Kombination angeben, die in den xref:/setup/security/rbac/rbac_permissions.adoc[RBAC-Berechtigungen] definiert ist.  Beachten Sie, dass die Bindestriche (`+-+`) aus Ressourcennamen wegfallen, sodass die Berechtigung `+get-metric-bindings+` die Kubernetes RBAC-Ressource `+metricbindings+` mit dem Verb `+get+` wird.


== Fehlerbehebung

* Überprüfen Sie, ob der RBAC-Agent für den Cluster in der Lage ist, mit der Plattform zu kommunizieren.

* xref:/setup/security/rbac/rbac_permissions.adoc#_list_subjects_for_a_user[Überprüfen Sie die Benutzersubjekte] (Benutzer und Rollen).
  ** Überprüfen Sie die Rollenkonfiguration beim OIDC-Anbieter.
* xref:/setup/security/rbac/rbac_permissions.adoc#_show_granted_permissions[Überprüfen Sie die Berechtigung des Subjekts]
  ** Überprüfen Sie, ob die relevanten (Cluster)RoleBindings, die den Benutzer mit einer (Cluster)Rolle verknüpfen, vorhanden sind.
  ** Überprüfen Sie die (Cluster)Rolle, um sicherzustellen, dass sie die richtigen Berechtigungen gewährt.
